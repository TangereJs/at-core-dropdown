<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>show hide flows demo</title>
  <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="../../at-theme/at-theme.html" />
  <link rel="import" href="../at-core-dropdown.html" />
  <link rel="import" href="../../at-carbon-icon-button/at-carbon-icon-button.html" />
  <style>
    html * {
      box-sizing: border-box;
    }

    .demo-controls-container {
      flex: 4;
    }

    .demo-content-container {
      flex: 8;
    }

    img {
      display: block;
    }
  </style>
</head>

<body>
  <h1>Show hide flows demo</h1>
  <div>
    <h4>Flow 1. Open with show() close with hide()</h4>
    <p>show() and hide() are called programmatically, hide() 10s after show().</p>
    
    <div class="horizontal layout">
      <div class="demo-controls-container">
        <button id="demo1Start">Start demo</button>
        <span hidden id="demo1Countdown"></span>
      </div>
      <div class="demo-content-container">
        <at-carbon-icon-button id="demo1RelativeTo" icon="now:menu"></at-carbon-icon-button>
        <at-core-dropdown id="demo1Dropdown" position="bottomLeft">
          <img src="http://placehold.it/350x150">
        </at-core-dropdown>
      </div>
    </div>

  </div>

  <div>
    <h4>Flow 2. Open with toggle() close with toggle()</h4>
    <p>toggle is called programmatically, 10s from open to close.</p>
    
    <div class="horizontal layout">
      <div class="demo-controls-container">
        <button id="demo2Start">Start demo</button>
        <span hidden id="demo2Countdown"></span>
      </div>
      <div class="demo-content-container">
        <at-carbon-icon-button id="demo2RelativeTo" icon="now:menu"></at-carbon-icon-button>
        <at-core-dropdown id="demo2Dropdown" position="bottomLeft">
          <img src="http://placehold.it/350x150">
        </at-core-dropdown>
      </div>
    </div>

  </div>

  <div>
    <h4>Flow 3. Open with toggle() close with hide()</h4>
    <p>toggle is called programmatically, 10s from open to close.</p>
    
    <div class="horizontal layout">
      <div class="demo-controls-container">
        <button id="demo3Start">Start demo</button>
        <span hidden id="demo3Countdown"></span>
      </div>
      <div class="demo-content-container">
        <at-carbon-icon-button id="demo3RelativeTo" icon="now:menu"></at-carbon-icon-button>
        <at-core-dropdown id="demo3Dropdown" position="bottomLeft">
          <img src="http://placehold.it/350x150">
        </at-core-dropdown>
      </div>
    </div>

  </div>

  <div>
    <h4>Flow 4. Open with show() close with toggle()</h4>
    <p>show is called programmatically, 10s from open to close.</p>
    
    <div class="horizontal layout">
      <div class="demo-controls-container">
        <button id="demo4Start">Start demo</button>
        <span hidden id="demo4Countdown"></span>
      </div>
      <div class="demo-content-container">
        <at-carbon-icon-button id="demo4RelativeTo" icon="now:menu"></at-carbon-icon-button>
        <at-core-dropdown id="demo4Dropdown" position="bottomLeft">
          <img src="http://placehold.it/350x150">
        </at-core-dropdown>
      </div>
    </div>

  </div>

  <div>
    <h4>Flow 5. Open with show() close with tapping #mask</h4>
    <p>show is called programmatically, closed manually</p>
    
    <div class="horizontal layout">
      <div class="demo-controls-container">
        <button id="demo5Start">Start demo</button>
        <span hidden id="demo5Countdown"></span>
      </div>
      <div class="demo-content-container">
        <at-carbon-icon-button id="demo5RelativeTo" icon="now:menu"></at-carbon-icon-button>
        <at-core-dropdown id="demo5Dropdown" position="bottomLeft">
          <img src="http://placehold.it/350x150">
        </at-core-dropdown>
      </div>
    </div>

  </div>

  <div>
    <h4>Flow 6. Open with toggle() close with tapping #mask</h4>
    <p>toggle is called programmatically, closed manually</p>
    
    <div class="horizontal layout">
      <div class="demo-controls-container">
        <button id="demo6Start">Start demo</button>
        <span hidden id="demo6Countdown"></span>
      </div>
      <div class="demo-content-container">
        <at-carbon-icon-button id="demo6RelativeTo" icon="now:menu"></at-carbon-icon-button>
        <at-core-dropdown id="demo6Dropdown" position="bottomLeft">
          <img src="http://placehold.it/350x150">
        </at-core-dropdown>
      </div>
    </div>

  </div>

  <div>
    <h4>Flow 7. Open with open=true close with open=false</h4>
    <p>open true|false is set programmatically, 10s to hide</p>
    
    <div class="horizontal layout">
      <div class="demo-controls-container">
        <button id="demo7Start">Start demo</button>
        <span hidden id="demo7Countdown"></span>
      </div>
      <div class="demo-content-container">
        <at-carbon-icon-button id="demo7RelativeTo" icon="now:menu"></at-carbon-icon-button>
        <at-core-dropdown id="demo7Dropdown" position="bottomLeft">
          <img src="http://placehold.it/350x150">
        </at-core-dropdown>
      </div>
    </div>

  </div>

  <div>
    <h4>Flow 8. Open with open=true close with hide()</h4>
    <p>open true is set programmatically, 10s to hide</p>
    
    <div class="horizontal layout">
      <div class="demo-controls-container">
        <button id="demo8Start">Start demo</button>
        <span hidden id="demo8Countdown"></span>
      </div>
      <div class="demo-content-container">
        <at-carbon-icon-button id="demo8RelativeTo" icon="now:menu"></at-carbon-icon-button>
        <at-core-dropdown id="demo8Dropdown" position="bottomLeft">
          <img src="http://placehold.it/350x150">
        </at-core-dropdown>
      </div>
    </div>

  </div>

  <div>
    <h4>Flow 9. Open with open=true close with toggle()</h4>
    <p>open true is set programmatically, 10s to hide</p>
    
    <div class="horizontal layout">
      <div class="demo-controls-container">
        <button id="demo9Start">Start demo</button>
        <span hidden id="demo9Countdown"></span>
      </div>
      <div class="demo-content-container">
        <at-carbon-icon-button id="demo9RelativeTo" icon="now:menu"></at-carbon-icon-button>
        <at-core-dropdown id="demo9Dropdown" position="bottomLeft">
          <img src="http://placehold.it/350x150">
        </at-core-dropdown>
      </div>
    </div>

  </div>

  <div>
    <h4>Flow 10. Open with open=true close with toggle()</h4>
    <p>open true is set programmatically, 10s to hide</p>
    
    <div class="horizontal layout">
      <div class="demo-controls-container">
        <button id="demo10Start">Start demo</button>
        <span hidden id="demo10Countdown"></span>
      </div>
      <div class="demo-content-container">
        <at-carbon-icon-button id="demo10RelativeTo" icon="now:menu"></at-carbon-icon-button>
        <at-core-dropdown id="demo10Dropdown" position="bottomLeft">
          <img src="http://placehold.it/350x150">
        </at-core-dropdown>
      </div>
    </div>

  </div>

  <div>
    <h4>Flow 11. Open with show() close with open=false</h4>
    <p>open true is set programmatically, 10s to hide</p>
    
    <div class="horizontal layout">
      <div class="demo-controls-container">
        <button id="demo11Start">Start demo</button>
        <span hidden id="demo11Countdown"></span>
      </div>
      <div class="demo-content-container">
        <at-carbon-icon-button id="demo11RelativeTo" icon="now:menu"></at-carbon-icon-button>
        <at-core-dropdown id="demo11Dropdown" position="bottomLeft">
          <img src="http://placehold.it/350x150">
        </at-core-dropdown>
      </div>
    </div>

  </div>

  <div>
    <h4>Flow 12. Open with toggle() close with open=false</h4>
    <p>open true is set programmatically, 10s to hide</p>
    
    <div class="horizontal layout">
      <div class="demo-controls-container">
        <button id="demo12Start">Start demo</button>
        <span hidden id="demo12Countdown"></span>
      </div>
      <div class="demo-content-container">
        <at-carbon-icon-button id="demo12RelativeTo" icon="now:menu"></at-carbon-icon-button>
        <at-core-dropdown id="demo12Dropdown" position="bottomLeft">
          <img src="http://placehold.it/350x150">
        </at-core-dropdown>
      </div>
    </div>

  </div>

  <script>
    /*
      flow1. open with show(), close with hide()
      flow2. open with toggle(), close with toggle()
      flow3. open with toggle(), close with hide()
      flow4. open with show(), close with toggle()

      flow5. open with show(), close by clicking #mask in at-core-dropdown-impl
      flow6. open with toggle(), close by clicking #mask in at-core-dropdown-impl

      flow7. open with .open = true, close with .open = false
      flow8. open with .open = true, close with hide()
      flow9. open with .open = true, close with toggle()
      flow10. open with .open = true, close by clicking #mask

      flow11. open with show() close with open = false
      flow12. open with toggle() close with open = false
    */
    document.addEventListener('WebComponentsReady', function(event) {
      init('demo1Start', 'demo1RelativeTo', 'demo1Dropdown', 'demo1Countdown', 10, 'show', 'hide');
      init('demo2Start', 'demo2RelativeTo', 'demo2Dropdown', 'demo2Countdown', 10, 'toggle', 'toggle');
      init('demo3Start', 'demo3RelativeTo', 'demo3Dropdown', 'demo3Countdown', 10, 'toggle', 'hide');
      init('demo4Start', 'demo4RelativeTo', 'demo4Dropdown', 'demo4Countdown', 10, 'show', 'toggle');
      init('demo5Start', 'demo5RelativeTo', 'demo5Dropdown', 'demo5Countdown', 10, 'show', false);
      init('demo6Start', 'demo6RelativeTo', 'demo6Dropdown', 'demo6Countdown', 10, 'toggle', false);
      init('demo7Start', 'demo7RelativeTo', 'demo7Dropdown', 'demo7Countdown', 10, 'open', 'open');
      init('demo8Start', 'demo8RelativeTo', 'demo8Dropdown', 'demo8Countdown', 10, 'open', 'hide');
      init('demo9Start', 'demo9RelativeTo', 'demo9Dropdown', 'demo9Countdown', 10, 'open', 'toggle');
      init('demo10Start', 'demo10RelativeTo', 'demo10Dropdown', 'demo10Countdown', 10, 'open', false);
      init('demo11Start', 'demo11RelativeTo', 'demo11Dropdown', 'demo11Countdown', 11, 'show', 'open');
      init('demo12Start', 'demo12RelativeTo', 'demo12Dropdown', 'demo12Countdown', 12, 'toggle', 'open');

      function init(startId, relativeToId, dropdownId, countdownId, hideTimeout, openWith, closeWith) {
        var startButton = document.getElementById(startId);
        var relativeToButton = document.getElementById(relativeToId);
        var coreDropdown = document.getElementById(dropdownId);
        var demoCountdown = document.getElementById(countdownId);
        var currentCountdown = hideTimeout;

        startButton.addEventListener('click', function() {
          currentCountdown = hideTimeout;
          if (openWith === "show") {
            coreDropdown.show(null, relativeToButton);
          } else if (openWith === "toggle") {
            coreDropdown.toggle(relativeToButton, null);
          } else if (openWith === "open") {
            coreDropdown.open = true;
          }
          
          if (!closeWith) return;

          demoCountdown.textContent = "Closing dropdown in " + currentCountdown;
          demoCountdown.removeAttribute('hidden');
          var hideInterval = setInterval(function() {
            demoCountdown.textContent = "Closing dropdown in " + currentCountdown;
            currentCountdown -= 1;
            if (currentCountdown > -1) return;
            clearInterval(hideInterval);
            demoCountdown.setAttribute('hidden', true);
            if (closeWith === 'hide') {
              coreDropdown.hide();
            } else if (closeWith === 'toggle') {
              coreDropdown.toggle(relativeToButton, null);
            } else if (closeWith === "open") {
              coreDropdown.open = false;
            }
          }, 1000);
        });
      }
    });
  </script>
</body>

</html>
